from recipes_parser.parsers.ingredients_parser import IngredientsParser


class TestIngredientsParser:
    def test_read_videos(self):
        def handle_result(videos_with_ingredients, output_path):
            assert len(videos_with_ingredients) == 63

        parser = IngredientsParser('../resources/videos-output', '.', handle_result)
        parser.run()

    def test_extract_ingredients_section(self):
        description = "LEARN HOW TO MAKE JAPANESE WAKAME SEAWEED SALAD AT HOME\n\nLAY HO MA!!  This is by far one of my favourite salads of all time.  It's super fresh, crunchy, and packed with incredible flavour.  This salad goes real well with sushi or really just on it's own!  Join me in this episode and learn how to make this easy Japanese wakame seaweed salad recipe.  Let's begin\n\nIngredients: \n3 cups water \n15g wakame dried seaweed \n1 cup arugula (packed) \n1/4 cup corn\r\n1/4 cup edamame \n1/2 heirloom tomato\r\n1 1/2 tbsp cane sugar \n1 tbsp rice vinegar \n1 1/2 tbsp soy sauce \n1 tsp toasted sesame oil\r\n2 tbsp white sesame seeds \n1/4 cup carrot (shredded) \r1/4 cup daikon (shredded)\r\n\nDirections:\n1. Bring the water to boil.  Then, turn off the heat and soak the dried seaweed in the hot water for a few minutes\r2. Strain out the seaweed through a colander keeping the water for another recipe.  Rinse the seaweed with some cold running water\n3. Add the cane sugar, rice vinegar, soy sauce, sesame oil, and 1 tbsp of white sesame seeds to a small mason jar.  Seal the lid and give it a good shake\r\n4. Roughly chop the seaweed and add to a large mixing bowl along with the arugula, corn, edamame, and tomatoes.  Pour in 3/4 of the dressing and mix\r5. Assemble your salad by dividing and scooping the salad into your serving bowls.  Then, divide and top the salad with the shredded carrot and shredded daikon.  \r\n6. Spoon over a little more of the dressing and sprinkle with the remaining white sesame seeds\r\n\n\nORDER YOUR SIGNED VEGAN RAMEN COOKBOOK + GET YOUR FREE E-BOOK + TAKE YOUR VEGAN SUSHI MASTERCLASS HERE:\nhttps://www.yeungmancooking.com\n\nIf you enjoyed this episode and would love to see more, remember to like, comment, and subscribe so that you won't miss a single episode!\n\nHong Kong born Canadian, Wil Yeung is an international photographer, filmmaker, entrepreneur, violinist, and YouTube chef.  He immigrated to Canada when he was a young boy carrying with him his ability to speak Cantonese and some broken English.  Much of his culinary aspirations stem from his background in the visual and musical art spaces.  Whether you're plant based or plant based curious, Wil believes that learning how to make food can really change your life and of those around you.\n\nSTAY IN THE LOOP ON SOCIAL MEDIA!\nWil's Recipes on Instagram:  @mr_wilyeung\nWil's Recipes on Facebook:  fb.me/mrwilyeung\nWil's Photography + Video on Instagram: @wyphotography.com\nWil's Photography + Video on Facebook: wyphotography\n\nYou are watching:\nhttps://youtu.be/06Joz01YmEY"
        parser = IngredientsParser('', '', '', '', '')
        result = parser.extract_ingredients_section_from_text(description)
        assert result == [" \n3 cups water \n15g wakame dried seaweed \n1 cup arugula (packed) \n1/4 cup corn\r\n1/4 cup edamame \n1/2 heirloom tomato\r\n1 1/2 tbsp cane sugar \n1 tbsp rice vinegar \n1 1/2 tbsp soy sauce \n1 tsp toasted sesame oil\r\n2 tbsp white sesame seeds \n1/4 cup carrot (shredded) \r1/4 cup daikon (shredded)\r\n\n"]

    def test_extract_ingredients_section_cmplx(self):
        description = "This is one of my all time favourites!  Whether you call it rice wraps, fresh rolls, Thai or Vietnamese spring rolls, I will teach you how to make this amazing vegan recipe together!  I will give you the confidence to make this dish from start to finish even including 2 amazing (and EASY) dipping sauces!  Remember to like, comment, and subscribe so you won't miss a single episode!\n\nThese will go perfect with a nice hot bowl of VEGAN PHO ;)\nhttps://www.youtube.com/watch?v=opUEhGZpXsw\n\nRice Wraps, Spring Rolls, Fresh Rolls, Rice Paper Rolls Ingredients:\n- rice wrap paper\n- extra firm tofu\n- English cucumber\n- mung bean or vermicelli noodles\n- fresh Thai basil\n- fresh mint\n- red or green leaf lettuce\n- cilantro\n- salt and pepper\n\nPeanut Sauce Ingredients:\n- 2 generous tbsp peanut butter\n- splash of coconut milk\n- 1 tbsp of tamari or soy sauce\n\nSpicy Soy Sauce Ingredients:\n- tamari or soy sauce\n- couple sprigs of cilantro\n- green onion\n- crushed chilli (or Asian chilli)\n- splash of toasted sesame oil\n\nRice Wrap / Fresh Rolls Directions:\n1. Start with the ingredient that takes the longest to cook/prep.  In this case, its the tofu.  Dry your extra firm tofu with a paper towel and slice into sticks\n2. season the tofu and cook in a 375F for 35-40min\n3. to prep your noodles, bring a pot of water to boil.  once boiling, take the pot off the heat and let the noodles soak for 3-5min.  Then stop it from overcooking by cooling it down with cold water\n4. start washing your greens in a sink full of cold water\n5. dry your greens and herbs after they are washed and set them aside\n6. once all your ingredients are prepped and ready to go, dip your rice paper onto a plate of water for about 30 sec.\n7. spread your rice paper on a cutting board and place in your prepped ingredients.\n8. to roll, take the flap closest to you and fold over.  Then tuck it in and roll it once.  Then tuck in both sides, and complete the roll.  That's it!\n\nDipping Sauce Directions:\n1. for the peanut sauce, place ingredients into the blender and blend on high speed.  If your sauce is too runny, add more peanut butter.  If its too thick, add more milk.\n2. for the spicy soy sauce, place the ingredients in a bowl and mix!\n\nIf you enjoyed this episode and would love to see more, remember to like, comment, and subscribe so that you won't miss a single episode!\n\nWil Yeung is a wedding and commercial photographer and videographer.  He is also the advertorial photographer for insauga.com, contract photographer for the city of Mississauga, and the official Japan Festival Canada photographer.  Join me on my channel for episodes on photography, entrepreneur motivation, and to learn to cook with absolute confidence!\n\nFollow me on social media!\n\nPhotography Instagram:\nhttps://www.instagram.com/wyphotography\nPhotography Facebook:\nhttps://www.facebook.com/wilyeungphotography\n\nVegan Recipes Instagram:  @mr_wilyeung\nVegan Recipes Facebook:  fb.me/mrwilyeung\n\nMY FAVOURITE KITCHEN TOOLS HERE:\nhttps://www.amazon.ca/shop/wilyeung\n\nORDER YOUR VEGAN RAMEN COOKBOOK HERE:\nhttps://www.wilyeung.com/cookbook\n\nYou are watching:\nhttps://youtu.be/54h_eOSx2mE"
        parser = IngredientsParser('', '', '', '', '')
        result = parser.extract_ingredients_section_from_text(description)
        assert result == ['\n- rice wrap paper\n- extra firm tofu\n- english cucumber\n- mung bean or vermicelli noodles\n- fresh thai basil\n- fresh mint\n- red or green leaf lettuce\n- cilantro\n- salt and pepper\n\npeanut sauce ', '\n- 2 generous tbsp peanut butter\n- splash of coconut milk\n- 1 tbsp of tamari or soy sauce\n\nspicy soy sauce ', '\n- tamari or soy sauce\n- couple sprigs of cilantro\n- green onion\n- crushed chilli (or asian chilli)\n- splash of toasted sesame oil\n\nrice wrap / fresh rolls ']
